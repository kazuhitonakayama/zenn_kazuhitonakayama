---
title: "Claude Code Actionã§è¤‡æ•°ãƒªãƒã‚¸ãƒˆãƒªã‚’æ¨ªæ–­ã—ã¦æƒ…å ±ã‚’å‚ç…§ã—èª¿æŸ»ãƒ»å®Ÿè£…ã‚’é€²ã‚ã¦ã‚‚ã‚‰ãŠã†"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["AI", "Claude Code Action", "Bedrock"]
published: true
---

## ã¯ã˜ã‚ã«
æœ¬è¨˜äº‹ã¯[GMOãƒšãƒ‘ãƒœ ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼](https://adventar.org/calendars/11929)3æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

ã“ã‚Œã¾ã§ä»¥ä¸‹ã®ã‚ˆã†ãªClaude Code Actionã®è¨˜äº‹ã‚’æ›¸ã„ã¦ãã¾ã—ãŸã€‚
- [Claude Codeã§Bedrock Claude Sonnet 4ã®429 too many tokensã‚¨ãƒ©ãƒ¼ã‚’ç·©å’Œã™ã‚‹](https://zenn.dev/pepabo/articles/d7de82614e2f0b)
- [Amazon Bedrockã‚’é€šã—ã¦Claude CodeãŠã‚ˆã³Claude Code Actionsã‚’ä½¿ç”¨ã™ã‚‹éš›ã®ã‚³ã‚¹ãƒˆç®¡ç†ã®ä»Š](https://zenn.dev/pepabo/articles/d2b37e19ca61da)
- [Claude Code Actionsã¨Figma MCPã§ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆé–‹ç™ºã‚’åŠ é€Ÿã™ã‚‹](https://zenn.dev/pepabo/articles/6668e1f44d6596)

ä»Šå›ã¯ã€è¡¨é¡Œã®é€šã‚Šã€Githubã«å°å…¥ã—ã¦ã„ã‚‹Claude Code ActionãŒãƒªãƒã‚¸ãƒˆãƒªã‚’æ¨ªæ–­ã—ã¦æƒ…å ±ã‚’é›†ã‚ã€èª¿æŸ»ãƒ»å®Ÿè£…ã‚’é€²ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ãŸæ™‚ã«ã‚„ã‚‰ãªã‘ã‚Œã°ã„ã‘ãªã‹ã£ãŸã“ã¨ã‚’ä¼ãˆãŸã„ã¨æ€ã„ã¾ã™ã€‚

## å‰æ
ç§ãŒæ‰€å±ã™ã‚‹GMOãƒšãƒ‘ãƒœ suzuriãƒ»minneäº‹æ¥­éƒ¨ã«ãŠã‘ã‚‹minneã®ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆé–‹ç™ºã«ãŠã„ã¦ã¯ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã‚ã‚‹Railsã®ãƒªãƒã‚¸ãƒˆãƒªã¨ã€Webãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã‚ã‚‹Next.jsã®ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆ†ã‘ã¦é–‹ç™ºã‚’ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€minneã¯iOSã‚¢ãƒ—ãƒªãƒ»Androidã‚¢ãƒ—ãƒªã‚‚æä¾›ã—ã¦ã„ã‚‹ã®ã§ã€ãã‚Œã‚‰ã«ã¤ã„ã¦ã‚‚å€‹åˆ¥ã«ãƒªãƒã‚¸ãƒˆãƒªãŒå­˜åœ¨ã—ã¦ã„ã¾ã™ã€‚

ãã—ã¦ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã‚ã‚‹Railsã§ã¯GraphQL APIã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå‘ã‘ã«æä¾›ã—ã¦ãŠã‚Šã€å„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãã®GraphQL APIã‚’é€šã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹•ä½œã«å¿…è¦ãªæƒ…å ±ã®å–å¾—ãƒ»æ›´æ–°ã‚’ã—ã¦ã„ã¾ã™ã€‚ï¼ˆminneã§ã®GraphQLã®æ¨é€²ã«ã¤ã„ã¦èˆˆå‘³ãŒã‚ã‚‹æ–¹ã¯ã“ã¡ã‚‰ã‚’å‚ç…§ã•ã‚ŒãŸã„ã§ã™ã€‚ref: [minneã¯ãªã›ã‚™GraphQLã‚’æ¨é€²ã—ã¦ã„ã‚‹ã‹](https://speakerdeck.com/kazuhitonakayama/minnehanasegraphqlwotui-jin-siteiruka)ï¼‰

æ—¢ã«å„ãƒªãƒã‚¸ãƒˆãƒªã«Claude Code Actionã¯å°å…¥ã—ã¦ã„ãŸã®ã§ã™ãŒã€ä¾‹ãˆã°Next.jsã®ãƒªãƒã‚¸ãƒˆãƒªã®issueãƒ»PRã§å‹•ä½œã™ã‚‹Claude Code Actionã‹ã‚‰ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰æä¾›ã•ã‚Œã‚‹GraphQL APIã®å‡¦ç†ã®å®Ÿè£…ã‚„ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®éå»ã®issueã‚„PRã®æƒ…å ±ã¯å‚ç…§ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

ã‚ã‚‹ã„ã¯ã€ä¾‹ãˆã°Railsã®ãƒªãƒã‚¸ãƒˆãƒªã®issueãƒ»PRã§å‹•ä½œã™ã‚‹Claude Code Actionã‹ã‚‰ã€iOSã‚„Androidãƒªãƒã‚¸ãƒˆãƒªã§RailsãŒæä¾›ã™ã‚‹ä»»æ„ã®GraphQL APIãŒå®Ÿéš›ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚

## å®Ÿç¾ã—ãŸã“ã¨
ãã“ã§ã€æ—¢å­˜ã®Claude Code Actionã‚’å‹•ä½œã•ã›ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«ãŠã„ã¦ã€gh cliã‚³ãƒãƒ³ãƒ‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€Github App Tokenã‚’ä½¿ã†ã“ã¨ã§Claude Code ActionãŒãƒªãƒã‚¸ãƒˆãƒªæ¨ªæ–­ã§ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãƒ»issueãƒ»PRãªã©ã®æƒ…å ±ã‚’æ¢ç´¢ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

![å®Ÿéš›ã«ãƒªãƒã‚¸ãƒˆãƒªæ¨ªæ–­ã§æ¢ç´¢ã—ã¦ã„ã‚‹æ§˜å­](/images/dd88b3698b8a84/claude-code-action-demo.png)

### å¿…è¦ã ã£ãŸã“ã¨
- Github appã®ä½œæˆ
  - Claude Code ActionãŒæ¨ªæ–­ã—ã¦æ¢ç´¢ã—ã¦ã»ã—ã„ãã‚Œãã‚Œã®ãƒªãƒã‚¸ãƒˆãƒªã®`Settings`ã«ã¦ã€æœ¬Github Appã¸ãƒªãƒã‚¸ãƒˆãƒªã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ã“ã¨
  - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«ãŠã„ã¦ã€create tokenæ™‚ã«minneé…ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’ä»˜ä¸ï¼ˆ`owner: minne`ï¼‰
- ghã‚³ãƒãƒ³ãƒ‰ã®install
- Bash, Read toolsã®allow

### å¤‰æ›´å‰ã®ã‚³ãƒ¼ãƒ‰
```yml
name: Claude PR Action

permissions:
  contents: write
  pull-requests: write
  issues: write
  id-token: write 

on:
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]
  issues:
    types: [opened, assigned]

jobs:
  claude-pr:
    if: |
      (github.event_name == 'issue_comment' && contains(github.event.comment.body, '@claude')) ||
      (github.event_name == 'pull_request_review_comment' && contains(github.event.comment.body, '@claude')) ||
      (github.event_name == 'issues' && contains(github.event.issue.body, '@claude'))
    runs-on: xxx
    env:
      AWS_REGION: xxx
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate GitHub App token
        id: app-token
        uses: actions/create-github-app-token@v2
        with:
          app-id: xxx
          private-key: xxx

      - name: Configure AWS Credentials
        uses: pepactions/configure-aws-credentials@v4
        with:
          audience: sts.amazonaws.com
          aws-region: xxx
          role-to-assume: xxx

      - uses: actions/claude-code-action
        with:
          model: # Bedrockã§æä¾›ã•ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ¨è«–ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ARN
          use_bedrock: "true"
          trigger_phrase: "@claude"
          timeout_minutes: "60"
          github_token: ${{ steps.app-token.outputs.token }}
```

### å¤‰æ›´å¾Œã®ã‚³ãƒ¼ãƒ‰
```yml
name: Claude PR Action 

permissions:
  contents: write
  pull-requests: write
  issues: write
  id-token: write 

on:
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]
  issues:
    types: [opened, assigned]

jobs:
  claude-pr:
    if: |
      (github.event_name == 'issue_comment' && contains(github.event.comment.body, '@claude')) ||
      (github.event_name == 'pull_request_review_comment' && contains(github.event.comment.body, '@claude')) ||
      (github.event_name == 'issues' && contains(github.event.issue.body, '@claude'))
    runs-on: xxx
    env:
      AWS_REGION: xxx
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate GitHub App token
        id: app-token
        uses: actions/create-github-app-token@v2
        with:
          app-id: xxx
          private-key: xxx
          owner: minne # ã“ã“ã§è‡ªèº«ã®orgã®åå‰ã‚’æŒ‡å®šã€‚ãã‚Œã«ã‚ˆã£ã¦æŒ‡å®šorgé…ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’å‚ç…§ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚‹ã€‚ãƒªãƒã‚¸ãƒˆãƒªã‚’å€‹åˆ¥ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã€‚

      - name: Configure AWS Credentials
        uses: pepactions/configure-aws-credentials@v4
        with:
          audience: sts.amazonaws.com
          aws-region: xxx
          role-to-assume: xxx

      - name: Install GitHub CLI
        run: |
          curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
          sudo chmod go+r /usr/share/keyrings/githubcli-archive-keyring.gpg
          echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null
          sudo apt update
          sudo apt install gh -y

      - name: Setup gh CLI with App Token
        env:
          GH_TOKEN: ${{ steps.app-token.outputs.token }}
        run: |
          echo "$GH_TOKEN" | gh auth login --hostname xxx --with-token

      - uses: actions/claude-code-action
        with:
          model: # Bedrockã§æä¾›ã•ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ¨è«–ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ARN
          use_bedrock: "true"
          trigger_phrase: "@claude"
          timeout_minutes: "60"
          github_token: ${{ steps.app-token.outputs.token }}
          allowed_tools: |
            Bash
            Read
            Glob
            Grep
```

## è‰¯ããªã£ãŸäº‹
è¤‡æ•°ãƒªãƒã‚¸ãƒˆãƒªãŒå­˜åœ¨ã—ã€ãã‚Œãã‚Œã®é€£æºãŒã‚ã‚‹ç§ãŸã¡ã®ã‚ˆã†ãªç’°å¢ƒã«ãŠã„ã¦ã¯æ¨ªæ–­çš„ã«Claude Code ActionãŒæƒ…å ±ã‚’æ¢ç´¢ã—ã¦ãã‚Œã‚‹ã“ã¨ã§ã‚ˆã‚Šèª¿æŸ»ã‚„å®Ÿè£…ãŒå®¹æ˜“ã«ãªã‚Šã¾ã—ãŸã€‚
